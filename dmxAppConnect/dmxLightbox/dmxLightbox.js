/*!
 DMXzone Lightbox
 Version: 1.0.0
 (c) 2017 DMXzone.com
 @build 2017-09-13 12:41:20
 */
!function(e){"use strict";function t(t,n){var o=e.createEvent("Event");o.initEvent(t,!0,!1),n.dispatchEvent(o)}function n(n){n.stopPropagation(),n.stopImmediatePropagation(),e[d.enabled]=e[r.enabled],e[d.element]=e[r.element],t(d.events.change,n.target)}function o(e){t(d.events.error,e.target)}function i(t){return function(n,o){function i(){n(),e.removeEventListener(r.events.change,i,!1)}function l(){o(new TypeError),e.removeEventListener(r.events.error,l,!1)}return t!==d.exit||e[r.element]?(e.addEventListener(r.events.change,i,!1),void e.addEventListener(r.events.error,l,!1)):void setTimeout(function(){o(new TypeError)},1)}}var r,l,s=!0,a={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitFullscreenEnabled",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}}},d=a.w3;for(l in a)if(a[l].enabled in e){r=a[l];break}return!s||d.enabled in e||!r||(e.addEventListener(r.events.change,n,!1),e.addEventListener(r.events.error,o,!1),e[d.enabled]=e[r.enabled],e[d.element]=e[r.element],e[d.exit]=function(){var t=e[r.exit]();return!t&&window.Promise?new Promise(i(d.exit)):t},Element.prototype[d.request]=function(){var e=this[r.request].apply(this,arguments);return!e&&window.Promise?new Promise(i(d.request)):e}),r}(document),function(){"use strict";function e(){P=w("div",{class:C("Overlay"),role:"dialog"}),k=w("div",{class:C("Slider")}),F=w("button",{class:C("Button","Prev"),type:"button","aria-label":"Previous"}),T=w("button",{class:C("Button","Next"),type:"button","aria-label":"Next"}),B=w("button",{class:C("Button","Close"),type:"button","aria-label":"Close"}),P.appendChild(k),P.appendChild(F),P.appendChild(T),P.appendChild(B),document.body.appendChild(P),document.addEventListener("focus",p,!0),document.addEventListener("fullscreenchange",f),P.addEventListener("click",g),F.addEventListener("click",x),T.addEventListener("click",b),B.addEventListener("click",v),P.addEventListener("touchstart",y),P.addEventListener("touchend",E),P.addEventListener("touchmove",L)}function t(e){dmx.lightbox.options.noscrollbars&&(document.documentElement.style.setProperty("overflow","hidden"),document.body.style.setProperty("overflow","scroll")),o()||(document.addEventListener("keydown",h),z=e,c(e,function(){s(e),l(e)}),m(e),P.style.setProperty("display","block"),dmx.lightbox.options.fullscreen&&P.requestFullscreen&&P.requestFullscreen(),setTimeout(function(){P.classList.add(O+"Visible"),dmx.lightbox.component&&dmx.lightbox.component.dispatchEvent("show")},50),S=document.activeElement,u())}function n(){if(o()){for(var e=P.getElementsByTagName("video"),t=0;t<e.length;t++)e[t].paused||e[t].pause();dmx.lightbox.options.noscrollbars&&(document.documentElement.style.removeProperty("overflow"),document.body.style.removeProperty("overflow")),document.removeEventListener("keydown",h),P.classList.remove(O+"Visible"),setTimeout(function(){P.style.removeProperty("display"),document.fullscreenElement&&document.exitFullscreen(),dmx.lightbox.component&&dmx.lightbox.component.dispatchEvent("hide")},500),S.focus()}}function o(){return"block"===P.style.display}function i(){z>=1?(z--,m(),l(z)):"none"!==dmx.lightbox.options.animation&&(k.classList.add(O+"BounceLeft"),setTimeout(function(){k.classList.remove(O+"BounceLeft")},400))}function r(){z<=q.images.length-2?(z++,m(),s(z)):"none"!==dmx.lightbox.options.animation&&(k.classList.add(O+"BounceRight"),setTimeout(function(){k.classList.remove(O+"BounceRight")},400))}function l(e){c(e-1,function(){l(e-1)})}function s(e){c(e+1,function(){s(e+1)})}function a(e){for(q=e,d();k.firstChild;)k.removeChild(k.firstChild);for(var t=[],n=[],o=0;o<e.nodes.length;o++)e.images[o]||e.images.push(w("div",{id:O+"Image"+o,class:O+"Image"})),t.push(O+"Figure"+o),n.push(O+"Caption"+o),k.appendChild(e.images[o]);P.setAttribute("aria-labelledby",t.join(" ")),P.setAttribute("aria-describedby",n.join(" "))}function d(){var e=dmx.extend(dmx.lightbox.options);k.style.transition="fade"===e.animation?"opacity .4s ease":"slide"===e.animation?"":"none","auto"===e.buttons&&("ontouchstart"in window||1===q.nodes.length)&&(e.buttons="hide"),F.style.display=T.style.display="hide"===e.buttons?"none":""}function u(){"hide"!==dmx.lightbox.options.buttons?F.focus():B.focus()}function c(e,t){var n=q.images[e],o=q.nodes[e];if(n&&o)if(n.getElementsByTagName("figure")[0]){if(t&&t(),dmx.lightbox.options.autoplay)for(var i=P.getElementsByTagName("video"),r=0;r<i.length;r++)i[r]==n.querySelector("video")?i[r].play():i[r].paused||i[r].pause()}else{var l=w("figure",{id:O+"Figure"+e}),s=w("div",{class:C("Spinner",dmx.lightbox.options.spinner)});if(l.appendChild(s),o.title&&l.appendChild(w("figcaption",{id:O+"Caption"+e},o.title)),/\.(jpe?g|gif|png)$/i.test(o.href)){var a=w("img");a.onload=function(){l.removeChild(s),t&&t()},a.setAttribute("src",o.href),l.appendChild(a)}else if(/\.(mp4)$/i.test(o.href)){var d=w("video");d.controls=!0,d.loop=dmx.lightbox.options.loopvideo;var u=w("source",{src:o.href});d.addEventListener("canplay",function n(){d.removeEventListener("canplay",n),l.removeChild(s),t&&t(),dmx.lightbox.options.autoplay&&z===e&&d.play()}),d.appendChild(u),l.appendChild(d)}else l.appendChild(w("div",{},'<a href="'+o.href+'">Url not supported</a>')),l.removeChild(s),t&&t();n.appendChild(l)}}function m(){var e="translate3d("+100*-z+"%,0,0)";"fade"===dmx.lightbox.options.animation?(k.style.setProperty("opacity",0),setTimeout(function(){k.style.setProperty("transform",e),k.style.setProperty("opacity",1)},400)):k.style.setProperty("transform",e)}function p(e){o()&&!P.contains(e.target)&&(e.stopPropagation(),u())}function f(e){document.fullscreenElement||n()}function h(e){switch(e.keyCode){case 37:i();break;case 39:r();break;case 27:n()}}function g(e){e.target.id.indexOf("dmxLightboxImage")!==-1&&n()}function x(e){e.stopPropagation(),i()}function b(e){e.stopPropagation(),r()}function v(e){e.stopPropagation(),n()}function y(e){j.count++,j.startX=e.changedTouches[0].pageX,j.startY=e.changedTouches[0].pageY}function E(e){j.count--,j.done=!1}function L(e){if(!(j.done||j.count>1)){e.preventDefault();var t=e.changedTouches[0].pageX,o=e.changedTouches[0].pageY;t-j.startX>40?(j.done=!0,i()):t-j.startX<40?(j.done=!0,r()):o-j.startY>100&&n()}}function w(e,t,n){var o=document.createElement(e);return t&&Object.keys(t).forEach(function(e){o.setAttribute(e,t[e])}),n&&(o.innerHTML=n),o}function C(){return O+[].join.call(arguments," "+O)}dmx.lightbox={count:0,gallery:{},options:{fullscreen:!1,noscrollbars:!1,autoplay:!1,loopvideo:!1,buttons:"auto",animation:"slide",spinner:"Spinner1"}};var P,k,F,T,B,S,q,z,O="dmxLightbox",j={count:0};dmx.lightbox.register=function(e){return dmx.lightbox.component?console.warn("Only 1 lightbox component should be used on the page!"):void(dmx.lightbox.component=e)},dmx.lightbox.getGallery=function(e){return dmx.lightbox.gallery[e]||(dmx.lightbox.gallery[e]={nodes:[],images:[]}),dmx.lightbox.gallery[e]},dmx.lightbox.addToGallery=function(e,t){var n=dmx.lightbox.getGallery(e);n.nodes.push(t)},dmx.lightbox.setOptions=function(e){dmx.lightbox.options=dmx.extend(dmx.lightbox.options,e)},dmx.lightbox.run=function(n,o){var i=dmx.lightbox.gallery[n];return i?(P||e(),q!==i&&a(i),void t(i.nodes.indexOf(o))):alert("Gallery "+n+" does not exist.")}}(),dmx.Component("lightbox",{attributes:{fullscreen:{type:Boolean,default:!1},noscrollbars:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!1},loopvideo:{type:Boolean,default:!1},buttons:{type:String,default:"auto"},animation:{type:String,default:"slide"},spinner:{type:String,default:"Spinner1"}},events:{show:Event,hide:Event},render:function(e){dmx.lightbox.register(this),dmx.BaseComponent.prototype.render.call(this,e)},update:function(e){dmx.lightbox.setOptions(this.props)}}),dmx.Attribute("lightbox","mounted",function(e,t){var n=t.argument||"dmxImage"+ ++dmx.lightbox.count;dmx.lightbox.addToGallery(n,e),e.addEventListener("click",function(t){t.preventDefault(),dmx.lightbox.run(n,e)})});
//# sourceMappingURL=../maps/dmxLightbox.js.map
